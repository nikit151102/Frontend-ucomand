<div class="card">
    <p-toast></p-toast>
    <p-table [value]="Service.products" dataKey="id" [tableStyle]="{ 'min-width': '60rem' }"
        [expandedRowKeys]="expandedRows" (onRowExpand)="onRowExpand($event)" (onRowCollapse)="onRowCollapse($event)"
        [paginator]="true" [rows]="10" [rowsPerPageOptions]="[3,10, 25, 50, 100]" [sortMode]="'multiple'">
        
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 5rem"></th>
                <th pSortableColumn="title">Название <p-sortIcon field="title"></p-sortIcon></th>
                <th pSortableColumn="profession.name">Профессия <p-sortIcon field="profession.name"></p-sortIcon></th>
                <th pSortableColumn="skills">Навыки <p-sortIcon field="skills.name"></p-sortIcon></th>
                <th pSortableColumn="details">Детали <p-sortIcon field="details"></p-sortIcon></th>
                <th pSortableColumn="creationDate">Дата создания <p-sortIcon field="creationDate"></p-sortIcon></th>
                <th></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product let-expanded="expanded">
            <tr>
                <td>
                    <p-button type="button" pRipple [pRowToggler]="product" [text]="true" [rounded]="true"
                        [plain]="true" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></p-button>
                </td>
                <td>{{ product?.title }}</td>
                <td>    <div class="lookingCard">
                    <p class="chapterCard_value" style="margin-top: 0.5rem; width: 90%; margin-bottom: 0;     font-weight: 500;">
                      {{ product?.profession?.name | uppercase }}
                    </p>
                    <p [ngStyle]="{ 'border-color': getSkillsColor(product?.profession?.competenceLevel) }" class="lookingCard_level" *ngIf="product?.profession?.competenceLevel">
                      {{ getSkills(product?.profession?.competenceLevel) }}
                    </p>
                  </div></td>
                <td>
                    <div class="tags">
                        <ng-container *ngFor="let skill of product?.skills">
                            <div class="tag">
                                <p class="tagText">
                                    {{skill.name}}
                                </p>
                                <p [ngStyle]="{ 'background': getSkillsColor(skill.competenceLevel) }"
                                    class="tag-level">
                                    {{ getSkillText(skill.competenceLevel) }}
                                </p>
                            </div>
                        </ng-container>
                    </div>


                </td>
                <td>{{ product?.details }}</td>
                <td>{{ product?.creationDate | date:'yyyy-MM-dd' }}</td>
                <td>
                    <p-button icon="pi pi-pencil" [text]="true" (onClick)="editCard(product)"/>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-product>
            <tr>
                <td colspan="6">
                    <div class="p-3">
                        <h5>Информация о пользователе</h5>
                        <p-table [value]="[product?.user]" class="p-datatable-sm">
                            <ng-template pTemplate="header">
            <tr>
                <th>Имя</th>
                <th>Фамилия</th>
                <th>Возраст</th>
                <th>Электронная почта</th>
                <th>Телеграм</th>
                <th>Дата регистрации</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-user>
            <tr>
                <td>{{ user?.firstName }}</td>
                <td>{{ user?.lastName }}</td>
                <td>{{ user?.age }}</td>
                <td>{{ user?.email }}</td>
                <td>{{ user?.telegram }}</td>
                <td>{{ user?.dateOfRegistration | date:'yyyy-MM-dd' }}</td>
            </tr>
        </ng-template>
    </p-table>
</div>
</td>
</tr>
</ng-template>
</p-table>
</div>

<app-forms *ngIf="listCardsService.visibleForm" [editData]="editData" ></app-forms>
